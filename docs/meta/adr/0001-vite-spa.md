# ADR-0001: Выбор Vite SPA вместо Next.js

> **Статус:** Accepted  
> **Дата:** 2026-01-28  
> **Авторы:** —  
> **Связанные ADR:** —

## Контекст

При создании нового проекта «Ассистент» нужно было выбрать фреймворк. Предыдущий проект Pennora использовал Next.js 16 с App Router.

**Проблемы Pennora:**

1. Медленные переходы между вкладками (несколько секунд)
2. SSR на каждый роут — каждый переход = серверный раундтрип
3. Цепочки запросов: `getUser` → `profiles` → редирект → клиентские запросы
4. Сложность архитектуры: Server Components + Client Components + cookies

**Особенности нового проекта:**

1. Практически всё приложение за авторизацией
2. SEO не нужен для дашборда
3. Важна скорость навигации между разделами
4. Нужна простота разработки и деплоя

## Рассмотренные варианты

### Вариант 1: Next.js (как в Pennora)

**Описание:** Продолжить с Next.js, оптимизировать текущий код.

**Плюсы:**

- Знакомый стек
- SSR для лендинга
- Встроенный API routes

**Минусы:**

- Оверхед SSR для закрытого приложения
- Гидрация замедляет первую интерактивность
- Сложность Server/Client Components
- Проблема медленных переходов останется (архитектурная)

### Вариант 2: Vite + React SPA

**Описание:** Чистый SPA на Vite с React Router.

**Плюсы:**

- Мгновенные переходы (клиентская навигация)
- Простая архитектура
- Быстрая разработка (Vite HMR)
- Лёгкий деплой (статика)
- Меньше кода, меньше сложности

**Минусы:**

- Нет SSR (не проблема для закрытого приложения)
- Нужен отдельный backend для сложной логики
- Больший initial bundle (решается code splitting)

### Вариант 3: Next.js с чисто клиентским подходом

**Описание:** Next.js, но все роуты — Client Components, без SSR для данных.

**Плюсы:**

- Можно переиспользовать часть кода Pennora
- SSR для лендинга

**Минусы:**

- Оверхед Next.js без его преимуществ
- Гидрация всё равно происходит
- Сложнее, чем чистый SPA

## Решение

Выбран **Вариант 2: Vite + React SPA** потому что:

1. **Скорость навигации** — клиентский роутинг = мгновенные переходы
2. **Простота** — нет Server/Client разделения, нет гидрации
3. **SEO не нужен** — всё приложение за авторизацией
4. **Быстрая разработка** — Vite значительно быстрее webpack
5. **Лёгкий деплой** — статика на любом хостинге

## Последствия

### Положительные

- Мгновенные переходы между страницами
- Проще понимать и отлаживать код
- Быстрее dev-сервер
- Проще деплой (Vercel, Netlify, GitHub Pages, любой CDN)

### Отрицательные

- Лендинг без SSR (решаемо: лендинг маленький, prerendering возможен)
- Нужен backend для сложной логики (Supabase Edge Functions)
- Больший initial bundle (решаемо: code splitting, lazy loading)

### Нейтральные

- Нужно переписать роутинг (React Router вместо App Router)
- Нужно адаптировать компоненты из Pennora (убрать `use server`, `use client`)

## План реализации

1. ✅ Создать Vite + React проект
2. ✅ Настроить Tailwind CSS 4
3. ✅ Перенести тему и базовые UI компоненты
4. ✅ Создать лендинг
5. ⏳ Подключить Supabase Auth
6. ⏳ Перенести логику Finance модуля
7. ⏳ Настроить TanStack Query

## Ссылки

- [Vite документация](https://vitejs.dev/)
- [React Router документация](https://reactrouter.com/)
- [Pennora референс](../../../reference/pennora/)
